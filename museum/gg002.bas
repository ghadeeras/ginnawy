5 CLEAR 5000:ON STOP GOSUB 30000:STOP ON
10 SCREEN2,2,0:OPEN"grp:"AS#1:GOSUB50000
15 DEF FN F(U,V)=ABS(U-AA)+ABS(V-BB)
20 DIM  B(16,11):DIM T(5,1)
40 FOR M=0 TO 16:B(M,0)=12:B(M,11)=12:NEXT
50 FOR M=0 TO 11:B(0,M)=12:B(16,M)=12:NEXT
60 DIM S$(1)
70 FOR M=1 TO 8 :S$(0)= "" :S$(1)= ""
80 FOR E=0 TO 1
90 FOR L=1 TO 16
100 READ F$:S$(E)=S$(E)+CHR$(VAL("&h"+F$))
110 NEXT L,E
120 SPRITE$(M)= S$(0)+S$(1)
130 NEXT M :ERASE S$:GOSUB 50160
140 DATA  3,4,4,3,0,7,1f,3f,7f,6f,ef,0,6f,7,4,e
141 DATAc0,20,20,c0,0,e0,f8,fc,fe,f6,f7,0,f6,e0,20,70
150 DATA 7,4,4,7,1,f,c,d,d,d,d,1,e,f,1,3,c0,20,20,c0,0,e0,30,b8,bc,bc,bc,80,7c,fc,0,c0
160 DATAf,8,8,f,0,1f,1c,1d,1d,1e,1f,0,1f,1f,2,7,80,40,40,80,0,c0,e0,70,b8,d8,68,0,f8,f9,2,84
170 DATA1,2,2,1,0,3,6,e,1e,1e,1e,0,1f,1f,0,1,f0,10,10,f0,0,f8,18,d8,d8,d8,d8,c0,38,f8,40,e0
180 DATA 1,2,2,1,0,3,7,f,1e,1d,1b,0,1f,9f,40,21,f0,10,10,f0,0,f8,98,58,d8,b8,78,0,f8,f8,40,e0
190 DATA3,4,64,3,e0,67,7f,3f,1f,f,f,0,cf,67,30,0,c0,20,26,c0,7,e6,fe,fc,f8,f0,f0,0,f3,e6,c,0
200 DATA f,34,44,44,84,84,84,84,84,84,84,84,84,ff,84,ff,f0,2c,22,22,21,21,21,21,21,21,21,21,21,ff,21,ff
205 DATAff,80,80,80,80,80,80,80,80,80,80,80,80,80,80,ff
206 DATAff,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,ff
210 COLOR1,1,1 :LINE(0,0)-(255,191),1,BF:LINE(6,14)-(248,178),15,B:LINE(7,15)-(249,177),15,B
250 X=8:Y=16:XX=1:YY=1:G=0:GG=0
260 PUTSPRITE0,(X,Y),3,8
270 S=STICK(0):S=(S+1)/2:I$=INKEY$
275 FOR M=1TO25 :NEXT
280 ON S GOTO 290,300,310,320
285 GOTO 330
290 IF YY>1 THEN Y=Y-16:YY=YY-1
295 GOTO 330
300 IF XX<15THEN X=X+16:XX=XX+1
305 GOTO 330
310 IF YY<10 THEN Y=Y+16:YY=YY+1
315 GOTO 330
320 IF XX>1THEN X=X-16:XX=XX-1
330 IF I$=""THEN 260
340 IF I$="e"THEN GOSUB 400
345 IF I$="f"THEN GOSUB 410
350 IF I$="x"THEN GOSUB 420
355 IF I$="c"THEN GOSUB 430
360 IF I$="t"THEN GOSUB 440
365 IF I$="k"THEN GOSUB 450
370 IF I$="w"THEN GOSUB 460
375 IF I$="d"THEN GOSUB 510
380 IF I$="g"THEN GOSUB 470
385 IF I$="L"THEN GOSUB 480
390 IF I$="l"THEN GOSUB 490
391 IF I$="G"THEN GOSUB 475
395 IF I$=" "THEN GOSUB 500
398 IF I$="b"THEN GOSUB 520
399 I$="":GOTO 260
400 LINE(X,Y+1)-(X+15,Y+16),1,BF:B(XX,YY)=0:RETURN
410 GOSUB400:PSET(X+8,Y+16):DRAW"c3u6d5e2g2h2f2":CIRCLE(X+8,Y+8),2,9:PAINT(X+7,Y+8),9:B(XX,YY)=1:RETURN
420 GOSUB400:PSET(X+12,Y+14),7:DRAW"c7h6e2r2l2g4d2u2e2h1eg2":B(XX,YY)=2:RETURN
430 GOSUB400:PSET(X+2,Y+15),14:DRAW"c14r10l2u1l7r5l2u1l2":B(XX,YY)=3:RETURN
440 GOSUB400:CIRCLE(X+8,Y+12),3,10:CIRCLE(X+8,Y+12),1,10:PAINT(X+8,Y+12),10:LINE(X+6,Y+14)-(X+10,Y+15),10,BF:B(XX,YY)=4:RETURN
450 GOSUB400:PSET(X+8,Y+15),8:DRAW"C8R2L2U2R2L2U4R2U2L2L2D2R2":B(XX,YY)=5:RETURN
460 GOSUB400:LINE(X,Y+1)-(X+15,Y+16),4,BF:B(XX,YY)=-1:RETURN
470 GG=1:PUTSPRITE2,(X,Y),5,1:A=X:B=Y:AA=XX:BB=YY:BEEP:RETURN
475 G=1:PUTSPRITE 1,(X,Y),3,1:BEEP:U=X:UU=XX:V=Y:VV=YY:RETURN
480 GOSUB400:PRESET(X+1 ,Y+1):DRAW"C1R3C5R7F1R1F1D1F1D10L15U10E1UERERBD15C5L5R15":B(XX,YY)=8:RETURN
490 GOSUB400:PRESET(X+1,Y+1):DRAW"C1R3C5R7F1R1F1D1F1D10L15U10E1UERERBD15C5L5R15":B(XX,YY)=9:RETURN
500 GOSUB400:LINE(X,Y+1)-(X+3,Y+6),15,BF:LINE(X+6,Y+1)-(X+15,Y+6),15,BF:LINE(X,Y+9)-(X+9,Y+14),15,BF:LINE(X+12,Y+9)-(X+15,Y+14),15,BF
505 B(XX,YY)=11:RETURN
510 GOSUB400:PSET(X+1,Y+15),6:DRAW"s4C6U10E4R5F4D11L13R3U14D14R3U14r1D14R3U14D14R3U11":B(XX,YY)=10:RETURN
520 IF G<1ORGG<1THENPRESET(8,180):COLOR15:PRINT#1,"WHERE IS GUFY?":RETURN
521 PUT SPRITE0,(0,0),0,8:LINE(0,180)-(256,192),1,BF:X=U:XX=UU:Y=V:YY=VV:COLOR15:PRESET( 88,180):PRINT#1,"LETS BEGIN!":RETURN 600
600 ON KEY GOSUB650,770,790,2000,2100,645,830,850
610 FOR M=1 TO 10 :KEY(M) ON:NEXT
620 ON STRIG  GOSUB 880:STRIG(0)ON
630 ON INTERVAL=500 GOSUB 1200
640 I=0:C=3:CC=5:P=1:GOTO 700
645 N=-1:GOTO 810
650 N=-1:GOTO 750
700 S=STICK(0):S=INT((S+1)/2)
705 IFS=0THEN PUT SPRITE1,(X,Y),C,1:GOTO 720
710 ONSGOSUB1000,1100,821,1100
720 IF B(XX,YY+1)<10AND B(XX,YY)<8 THEN GOSUB 900
730 IF B(XX,YY)=-1AND T(1,I)=0THEN GOSUB 2000
740 GOTO 700
750 IF  B(XX+N,YY) >0OR T(2,I)=0 OR COCO=1 THEN RETURN
755 IF B(XX+N,YY+1)<>11OR FNF(XX+N,YY)=0 THEN RETURN
760 LINE(X+16*N,Y+17)-(X+15+16*N,Y+32),1,BF:B(XX+N,YY+1)=0
765 T(2,I)=T(2,I)-1:RETURN
770 N=0 :GOTO 750
790 N=1 :GOTO 750
810 IF  B(XX+N,YY) >0 OR T(3,I)=0 OR COCO=1 THEN RETURN
812 IF FNF(XX+N,YY)*FNF(XX+N,YY+1)=0THEN RETURN
815 IF B(XX+N,YY+1)>7 THEN E=0:GOTO 822
820 IF B(XX+N,YY+1)<1 THEN E=1:GOTO 822
821 RETURN
822 X=X+N*16:Y=Y+E*16:XX=XX+N:YY=YY+E:GOSUB 500:T(3,I)=T(3,I)-1
825 X=X-N*16:Y=Y-E*16:XX=XX-N:YY=YY-E:RETURN
830 IF COCO=1 OR T(3,I)=0 OR B(XX,YY)> 7 OR FNF(XX,YY)=0 THEN RETURN
835 T(3,I)=T(3,I)-1
840 GOSUB 500:YY=YY-1:Y=Y-16
845 PUTSPRITE1,(X,Y),C,1:IF B(XX,YY)>9 THEN 2000
846 GOSUB 1300
847 RETURN
850 N=1:GOTO 810
880 IF COCO=1THEN RETURN
881 SWAP A,X:SWAP B,Y:SWAP YY,BB:SWAP XX,AA:SWAP C,CC:I=(I+1)MOD 2:PUTSPRITE1,(X,Y),C,1:PUTSPRITE2,(A,B),CC,1:RETURN
900 COCO=1:FOR M=1TO 16:Y=Y+1
910 PUT SPRITE 1,(X,Y),C,6:NEXT
920 YY=YY+1:GOSUB 1300
930 IF B(XX,YY+1)<10 AND B(XX,YY)<8THEN 900
940 COCO= 0:RETURN
1000 COCO=1:IF B(XX,YY)<8 THEN RETURN
1010 E=2*(B(XX,YY)MOD 2)-1
1020 PUT SPRITE 0,(X,Y),7,7:GOSUB 400
1030 IF B(XX,YY+E)>7THEN 1070
1040 FOR M=1TO 16
1050 Y=Y+E:PUT SPRITE1,(X,Y),C,1:PUT SPRITE 0,(X,Y),7,7
1060 NEXT:YY=YY+E:GOTO 1030
1070 IF E=-1THEN GOSUB 490 ELSE GOSUB 480
1080 PUT SPRITE0,(0,0),0,7:COCO=0:RETURN
1100 COCO=1: E=3-S:PUT SPRITE1,(X,Y),C,3-E:IF B(XX+E,YY)<=9THEN1150
1110 IF B(XX+E,YY)<>10ORT(5,I)=0THENCOCO=0:RETURN
1120 FOR M=0TO7:LINE(X+7+16*E-M,Y)-(X+8+16*E+M,Y+16),1,B
1130 NEXT
1140 T(5,I)=T(5,I)-1:B(XX+E,YY)=0
1150 XX=XX+E:X=X+E*4:PUT SPRITE 1,(X,Y),C,4-E
1160 PLAY"t255m2000s10o4c":FOR M=0TO100:NEXT     :X=X+E*8:PUT SPRITE1,(X,Y),C,3-E
1170 PLAY"t255o5c":FORM=1 TO100:NEXT     : X=X+E*4:GOSUB1300 :PUT SPRITE1,(X,Y),C,4-E:COCO=0
1180 RETURN
1200 T(1,I)=0:INTERVAL OFF:RETURN
1300 IF B(XX,YY)<6AND B(XX,YY)>1THEN T(B(XX,YY),I)=T(B(XX,YY),I)+1:GOSUB400
1310 IF B(XX,YY)=1THEN INTERVALON:T(1,I)=1:GOSUB400
1320 RETURN
2000 INTERVAL OFF:STRIG(0) OFF:LINE(0,0)-(255,12),1,BF:LINE(0,180)-(255,191),1,BF
2010 FOR M=1TO 10:KEY(M)OFF:NEXT:FOR M=1TO5:T(M,1)=0:T(M,0)=0:COLOR 15:PRESET(94,180):PRINT#1,"GAME OVER":NEXT
2020 IF INKEY$<>""THEN 2020
2023 PUT SPRITE1,(0,0),0,1
2024 PUT SPRITE2,(0,0),0,1
2050 LINE(0,180)-(255,191),1,BF:RETURN 250
2100 P=-P:IFP=-1THEN 2200ELSEPRESET(8,4)
2101 COLOR3:PRINT#1,"key=":PRESET(38,4):PRINT#1, T(5,0)
2110 PRESET (68,4):COLOR3:PRINT#1,"cem=":PRESET (98,4):PRINT#1, T(3,0)
2120 PRESET (128,4):COLOR5:PRINT#1,"key=":PRESET(158,4):PRINT#1, T(5,1)
2130 PRESET (188,4):COLOR5:PRINT#1,"cem=":PRESET(218,4):PRINT#1, T(3,1)
2140 PRESET (68 ,180):COLOR3:PRINT#1,"axe=":PRESET( 98,180):PRINT#1, T(2,0)
2150 PRESET (188,180):COLOR5:PRINT#1,"axe=":PRESET(218,180):PRINT#1, T(2,1):RETURN
2200 LINE(0,0)-(255,12),1,BF:LINE(0,180)-(255,192),1,BF:RETURN
30000 LINE(8,180)-(255,191),1,BF
30010 COLOR15:PRESET(8,180):PRINT#1,"PASSWORD":T$=INPUT$(6):IF T$="TABBY*"THEN END
30015 IF T$="TABBY*"THEN END
30020 LINE(8,180)-(100,191),1,BF:RETURN
50000 LINE(20,0)-(235,190),10,BF
50010 LINE(0,20)-(255,170),10,BF
50020 LINE(10,10)-(245,180),1,BF
50030 LINE(50,50)-(205,70),15,B
50040 LINE(52,52)-(203,68),8,B
50050 FOR A=10TO20STEP10
50060 CIRCLE(10,10),A,10,4.712385#,0
50070 CIRCLE(10,180),A,10,0,1.570795#
50080 CIRCLE(245,181),A,10,1.570795#,3.14159
50090 CIRCLE(245,10),A,10,3.14159,4.712385#:NEXT
50091 PAINT(20,20),10
50092 PAINT(20,170),10
50093 PAINT(230,170),10
50094 PAINT(230,20),10
50095 COLOR 3 :PRESET(59,56):PRINT#1,"A GUMY ";
50100 COLOR 15:PRINT#1,"and ";
50110 COLOR 5 :PRINT#1,"GUFY A"
50120 COLOR 15:PRESET(120,90):PRINT#1,"by"
50130 COLOR 15:PRESET(67,110):PRINT#1,"***GINAWY co.***"
50150 COLOR 4 :PRESET(52,170):PRINT#1,"all rights reserved":RETURN
50160 IF INKEY$=""THEN GOTO 50160
50170 IF INKEY$<>""THEN 50170
50180 RETURN